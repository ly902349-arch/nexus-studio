<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ¤– Ø§Ø®ØªØ¨Ø§Ø± Gemini AI - Nexus Studio</title>
    <style>
        * {
            font-family: 'Cairo', sans-serif;
            box-sizing: border-box;
        }
        
        body {
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: white;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        h1 {
            text-align: center;
            background: linear-gradient(45deg, #8b5cf6, #ec4899);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            margin-bottom: 30px;
        }
        
        .test-section {
            background: rgba(255, 255, 255, 0.15);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
        }
        
        .btn {
            display: inline-flex;
            align-items: center;
            gap: 10px;
            padding: 12px 24px;
            background: #6366f1;
            color: white;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-weight: bold;
            margin: 5px;
            transition: all 0.3s;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(99, 102, 241, 0.3);
        }
        
        .btn-success { background: #10b981; }
        .btn-warning { background: #f59e0b; }
        .btn-danger { background: #ef4444; }
        
        textarea {
            width: 100%;
            padding: 15px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 10px;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            font-size: 16px;
            margin: 10px 0;
            min-height: 100px;
        }
        
        textarea::placeholder {
            color: rgba(255, 255, 255, 0.5);
        }
        
        .result {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 15px;
            margin-top: 15px;
            white-space: pre-wrap;
            font-family: monospace;
            max-height: 300px;
            overflow-y: auto;
        }
        
        .success { border-right: 5px solid #10b981; }
        .error { border-right: 5px solid #ef4444; }
        .loading { border-right: 5px solid #f59e0b; }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ¤– Ø§Ø®ØªØ¨Ø§Ø± Gemini AI - Nexus Studio</h1>
        
        <div class="test-section">
            <h3>ğŸ”— Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø§ØªØµØ§Ù„</h3>
            <button class="btn" onclick="testConnection()">
                <i class="fas fa-plug"></i>
                Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ù€ API
            </button>
            <div id="connectionResult" class="result"></div>
        </div>
        
        <div class="test-section">
            <h3>ğŸ’¬ Ù…Ø­Ø§Ø¯Ø«Ø© Ù…Ø¨Ø§Ø´Ø±Ø©</h3>
            <textarea id="chatInput" placeholder="Ø§ÙƒØªØ¨ Ø±Ø³Ø§Ù„ØªÙƒ Ù‡Ù†Ø§..."></textarea>
            <button class="btn btn-success" onclick="sendChat()">
                <i class="fas fa-paper-plane"></i>
                Ø¥Ø±Ø³Ø§Ù„ Ø¥Ù„Ù‰ Gemini AI
            </button>
            <div id="chatResult" class="result"></div>
        </div>
        
        <div class="test-section">
            <h3>ğŸ¯ Ù…ÙŠØ²Ø§Øª Ù…ØªÙ‚Ø¯Ù…Ø©</h3>
            <div>
                <button class="btn" onclick="testVideoIdeas()">
                    <i class="fas fa-lightbulb"></i>
                    ØªÙˆÙ„ÙŠØ¯ Ø£ÙÙƒØ§Ø± ÙÙŠØ¯ÙŠÙˆ
                </button>
                <button class="btn" onclick="testScriptWriting()">
                    <i class="fas fa-scroll"></i>
                    ÙƒØªØ§Ø¨Ø© Ø³ÙŠÙ†Ø§Ø±ÙŠÙˆ
                </button>
                <button class="btn" onclick="testPerformanceAnalysis()">
                    <i class="fas fa-chart-line"></i>
                    ØªØ­Ù„ÙŠÙ„ Ø£Ø¯Ø§Ø¡
                </button>
                <button class="btn" onclick="testThumbnailDesign()">
                    <i class="fas fa-palette"></i>
                    ØªØµÙ…ÙŠÙ… Ø«Ø§Ù…Ø¨Ø±ÙŠÙ„
                </button>
                <button class="btn" onclick="testLiveStream()">
                    <i class="fas fa-broadcast-tower"></i>
                    ØªØ­Ø¶ÙŠØ± Ø¨Ø« Ù…Ø¨Ø§Ø´Ø±
                </button>
            </div>
            <div id="featureResult" class="result"></div>
        </div>
        
        <div class="test-section">
            <h3>ğŸ“Š Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ù†Ø¸Ø§Ù…</h3>
            <button class="btn btn-warning" onclick="getStats()">
                <i class="fas fa-chart-bar"></i>
                Ø¹Ø±Ø¶ Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª
            </button>
            <button class="btn btn-danger" onclick="clearHistory()">
                <i class="fas fa-trash"></i>
                Ù…Ø³Ø­ Ø§Ù„ØªØ§Ø±ÙŠØ®
            </button>
            <div id="statsResult" class="result"></div>
        </div>
    </div>

    <script src="public/js/config.js"></script>
    <script src="public/js/gemini-ai.js"></script>
    <script>
        // ØªÙ‡ÙŠØ¦Ø© Gemini AI
        document.addEventListener('DOMContentLoaded', function() {
            console.log('ğŸ”§ ØªÙ‡ÙŠØ¦Ø© Ø§Ø®ØªØ¨Ø§Ø± Gemini AI...');
            
            // ØªÙ‡ÙŠØ¦Ø© AI Ø¨Ø¹Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù„ÙØ§Øª
            setTimeout(() => {
                const ai = initGeminiAI();
                if (ai) {
                    showResult('connectionResult', 'âœ… Gemini AI Ù…Ù‡ÙŠØ£ ÙˆØ¬Ø§Ù‡Ø²!', 'success');
                } else {
                    showResult('connectionResult', 'âŒ ÙØ´Ù„ ØªÙ‡ÙŠØ¦Ø© Gemini AI', 'error');
                }
            }, 1000);
        });
        
        // Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø§ØªØµØ§Ù„
        async function testConnection() {
            showResult('connectionResult', 'ğŸ”Œ Ø¬Ø§Ø±ÙŠ Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø§ØªØµØ§Ù„...', 'loading');
            
            try {
                if (!window.gemini) {
                    initGeminiAI();
                }
                
                const result = await window.gemini.testConnection();
                
                if (result.connected) {
                    showResult('connectionResult', 
                        `âœ… Ø§ØªØµØ§Ù„ Ù†Ø§Ø¬Ø­!\n\n` +
                        `ğŸ“Š Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª:\n` +
                        `- Ø§Ù„ÙˆÙ‚Øª: ${new Date(result.details.responseTime).toLocaleTimeString('ar-EG')}\n` +
                        `- Ø§Ù„Ø±Ø³Ø§Ù„Ø©: "${result.details.message}"\n` +
                        `- Tokens: ${result.details.tokens}\n` +
                        `- Request ID: ${result.details.requestId}`,
                        'success'
                    );
                } else {
                    showResult('connectionResult', 
                        `âŒ ÙØ´Ù„ Ø§Ù„Ø§ØªØµØ§Ù„\n\n` +
                        `Ø§Ù„Ø®Ø·Ø£: ${result.error || 'ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ'}`,
                        'error'
                    );
                }
                
            } catch (error) {
                showResult('connectionResult', 
                    `ğŸ’¥ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±\n\n` +
                    `${error.message}\n\n` +
                    `Ø§Ù„Ù…ÙØªØ§Ø­: ${window.NEXUS_CONFIG?.GEMINI_API_KEY?.substring(0, 15) || 'ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯'}...`,
                    'error'
                );
            }
        }
        
        // Ø¥Ø±Ø³Ø§Ù„ Ù…Ø­Ø§Ø¯Ø«Ø©
        async function sendChat() {
            const input = document.getElementById('chatInput');
            const message = input.value.trim();
            
            if (!message) {
                showResult('chatResult', 'âš ï¸ Ø§Ù„Ø±Ø¬Ø§Ø¡ ÙƒØªØ§Ø¨Ø© Ø±Ø³Ø§Ù„Ø© Ø£ÙˆÙ„Ø§Ù‹', 'error');
                return;
            }
            
            showResult('chatResult', 'ğŸ¤– Ø¬Ø§Ø±ÙŠ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø±Ø³Ø§Ù„Ø©...', 'loading');
            
            try {
                const response = await chatWithGemini(message);
                
                if (response.success) {
                    showResult('chatResult', 
                        `âœ… Ø§Ù„Ø±Ø¯:\n\n${response.message}\n\n` +
                        `ğŸ“Š Ø§Ù„ØªÙØ§ØµÙŠÙ„:\n` +
                        `- Tokens: ${response.tokens}\n` +
                        `- Request ID: ${response.requestId}\n` +
                        `- Ø§Ù„ÙˆÙ‚Øª: ${new Date(response.responseTime).toLocaleTimeString('ar-EG')}`,
                        'success'
                    );
                } else {
                    showResult('chatResult', 
                        `âŒ ÙØ´Ù„ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„\n\n` +
                        `Ø§Ù„Ø®Ø·Ø£: ${response.error.message}\n\n` +
                        `Ø§Ù„Ø±Ø¯ Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠ:\n${response.message}`,
                        'error'
                    );
                }
                
            } catch (error) {
                showResult('chatResult', 
                    `ğŸ’¥ Ø®Ø·Ø£ ØºÙŠØ± Ù…ØªÙˆÙ‚Ø¹\n\n${error.message}`,
                    'error'
                );
            }
        }
        
        // Ø§Ø®ØªØ¨Ø§Ø± ØªÙˆÙ„ÙŠØ¯ Ø£ÙÙƒØ§Ø± Ø§Ù„ÙÙŠØ¯ÙŠÙˆ
        async function testVideoIdeas() {
            showResult('featureResult', 'ğŸ’¡ Ø¬Ø§Ø±ÙŠ ØªÙˆÙ„ÙŠØ¯ Ø£ÙÙƒØ§Ø± ÙÙŠØ¯ÙŠÙˆ...', 'loading');
            
            try {
                const response = await window.gemini.generateVideoIdeas('Ø§Ù„ØªØ³ÙˆÙŠÙ‚ Ø§Ù„Ø±Ù‚Ù…ÙŠ', 3);
                showResult('featureResult', response.message, response.success ? 'success' : 'error');
            } catch (error) {
                showResult('featureResult', `âŒ Ø®Ø·Ø£: ${error.message}`, 'error');
            }
        }
        
        // Ø§Ø®ØªØ¨Ø§Ø± ÙƒØªØ§Ø¨Ø© Ø§Ù„Ø³ÙŠÙ†Ø§Ø±ÙŠÙˆ
        async function testScriptWriting() {
            showResult('featureResult', 'ğŸ“ Ø¬Ø§Ø±ÙŠ ÙƒØªØ§Ø¨Ø© Ø³ÙŠÙ†Ø§Ø±ÙŠÙˆ...', 'loading');
            
            try {
                const response = await window.gemini.writeVideoScript('ÙƒÙŠÙÙŠØ© Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø­ØªÙˆÙ‰ Ù†Ø§Ø¬Ø­', 5);
                showResult('featureResult', response.message, response.success ? 'success' : 'error');
            } catch (error) {
                showResult('featureResult', `âŒ Ø®Ø·Ø£: ${error.message}`, 'error');
            }
        }
        
        // Ø§Ø®ØªØ¨Ø§Ø± ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø£Ø¯Ø§Ø¡
        async function testPerformanceAnalysis() {
            showResult('featureResult', 'ğŸ“Š Ø¬Ø§Ø±ÙŠ ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø£Ø¯Ø§Ø¡...', 'loading');
            
            try {
                const data = {
                    views: 1250,
                    engagement: '24.5%',
                    watchTime: '4:30',
                    platform: 'YouTube',
                    type: 'ØªØ¹Ù„ÙŠÙ…ÙŠ'
                };
                
                const response = await window.gemini.analyzePerformance(data);
                showResult('featureResult', response.message, response.success ? 'success' : 'error');
            } catch (error) {
                showResult('featureResult', `âŒ Ø®Ø·Ø£: ${error.message}`, 'error');
            }
        }
        
        // Ø§Ø®ØªØ¨Ø§Ø± ØªØµÙ…ÙŠÙ… Ø§Ù„Ø«Ø§Ù…Ø¨Ø±ÙŠÙ„
        async function testThumbnailDesign() {
            showResult('featureResult', 'ğŸ¨ Ø¬Ø§Ø±ÙŠ ØªØµÙ…ÙŠÙ… Ø«Ø§Ù…Ø¨Ø±ÙŠÙ„...', 'loading');
            
            try {
                const response = await window.gemini.designThumbnail(
                    'Ø£ÙØ¶Ù„ 10 Ù†ØµØ§Ø¦Ø­ Ù„Ù„ØªØ³ÙˆÙŠÙ‚ Ø§Ù„Ø±Ù‚Ù…ÙŠ ÙÙŠ 2024',
                    'Ø¬Ø°Ø§Ø¨ ÙˆØ§Ø­ØªØ±Ø§ÙÙŠ',
                    'ÙŠÙˆØªÙŠÙˆØ¨'
                );
                showResult('featureResult', response.message, response.success ? 'success' : 'error');
            } catch (error) {
                showResult('featureResult', `âŒ Ø®Ø·Ø£: ${error.message}`, 'error');
            }
        }
        
        // Ø§Ø®ØªØ¨Ø§Ø± ØªØ­Ø¶ÙŠØ± Ø§Ù„Ø¨Ø« Ø§Ù„Ù…Ø¨Ø§Ø´Ø±
        async function testLiveStream() {
            showResult('featureResult', 'ğŸ“¹ Ø¬Ø§Ø±ÙŠ ØªØ­Ø¶ÙŠØ± Ø¨Ø« Ù…Ø¨Ø§Ø´Ø±...', 'loading');
            
            try {
                const response = await window.gemini.prepareLiveStream(
                    'Ø§Ù„ØªØ³ÙˆÙŠÙ‚ Ø¹Ø¨Ø± ÙˆØ³Ø§Ø¦Ù„ Ø§Ù„ØªÙˆØ§ØµÙ„ Ø§Ù„Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠ',
                    60,
                    'Ø±ÙˆØ§Ø¯ Ø§Ù„Ø£Ø¹Ù…Ø§Ù„ ÙˆØ§Ù„Ù…Ø³ÙˆÙ‚ÙŠÙ†'
                );
                showResult('featureResult', response.message, response.success ? 'success' : 'error');
            } catch (error) {
                showResult('featureResult', `âŒ Ø®Ø·Ø£: ${error.message}`, 'error');
            }
        }
        
        // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª
        function getStats() {
            if (window.gemini) {
                const stats = window.gemini.getStats();
                showResult('statsResult', 
                    `ğŸ“Š Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Gemini AI:\n\n` +
                    `ğŸ“ Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø·Ù„Ø¨Ø§Øª: ${stats.totalRequests}\n` +
                    `âœ… Ø§Ù„Ù†Ø§Ø¬Ø­Ø©: ${stats.successfulRequests}\n` +
                    `âŒ Ø§Ù„ÙØ§Ø´Ù„Ø©: ${stats.failedRequests}\n` +
                    `ğŸ¯ Ù…Ø¹Ø¯Ù„ Ø§Ù„Ù†Ø¬Ø§Ø­: ${stats.successRate}%\n` +
                    `ğŸ”¤ Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù€ Tokens: ${stats.totalTokens}\n` +
                    `ğŸ“ˆ Ø§Ù„Ù…ØªÙˆØ³Ø·: ${stats.averageTokens} Ù„ÙƒÙ„ Ø·Ù„Ø¨\n` +
                    `ğŸ’¬ Ø·ÙˆÙ„ Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø©: ${stats.conversationLength} Ø±Ø³Ø§Ù„Ø©\n` +
                    `â° Ø¢Ø®Ø± Ø·Ù„Ø¨: ${stats.lastRequestTime ? new Date(stats.lastRequestTime).toLocaleString('ar-EG') : 'Ù„Ø§ ÙŠÙˆØ¬Ø¯'}`,
                    'success'
                );
            } else {
                showResult('statsResult', 'âŒ Gemini AI ØºÙŠØ± Ù…Ù‡ÙŠØ£', 'error');
            }
        }
        
        // Ù…Ø³Ø­ Ø§Ù„ØªØ§Ø±ÙŠØ®
        function clearHistory() {
            if (window.gemini && window.gemini.clearHistory()) {
                showResult('statsResult', 'ğŸ—‘ï¸ ØªÙ… Ù…Ø³Ø­ ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø© Ø¨Ù†Ø¬Ø§Ø­', 'success');
            } else {
                showResult('statsResult', 'âŒ ÙØ´Ù„ Ù…Ø³Ø­ Ø§Ù„ØªØ§Ø±ÙŠØ®', 'error');
            }
        }
        
        // Ø¹Ø±Ø¶ Ø§Ù„Ù†ØªØ§Ø¦Ø¬
        function showResult(elementId, message, type) {
            const element = document.getElementById(elementId);
            element.textContent = message;
            element.className = 'result ' + type;
            element.scrollTop = element.scrollHeight;
        }
    </script>
</body>
</html>